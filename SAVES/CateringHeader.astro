---
const navigation = [
  { label: "Home", href: "/eventi" },
  { label: "Servizi", href: "/eventi/servizi" },
  { label: "Portfolio", href: "/eventi/portfolio" },
  { label: "Partners", href: "/eventi/partners" },
  { label: "Contattaci", href: "#" },
];
---

<!-- CONTACT OVERLAY -->
<div
  id="contact-overlay"
  class="hidden fixed inset-0 z-[100]"
>
  <!-- AquÃ­ puedes montar ContactForm:
       - Astro
       - o React island -->
</div>

<header
  id="catering-header"
  class="w-full px-6 py-4 fixed inset-x-0 top-0 z-[9999] transition-all bg-transparent"
>
  <div class="flex max-w-[1300px] [@media(min-width:1300px)]:max-w-[90%]">

    <!-- Logo izquierda -->
    <div class="lg:pl-[10%] flex-1 flex items-center">
      <a href="/eventi" class="flex items-center">
        <img
          src="/assets/svg/LaCasonaCatering.svg"
          alt="Logo La Casona Catering"
          class="h-18 sm:h-24 w-auto"
        />
      </a>
    </div>

    <!-- Logo centro -->
    <div class="hidden md:flex flex-1 justify-center items-center">
      <a href="/" class="flex flex-col items-center">
        <img
          src="/assets/svg/LaCasonaGroup.svg"
          alt="Logo La Casona Group"
          class="max-h-3 w-auto"
        />
      </a>
    </div>

    <!-- Hamburguesa -->
    <div class="flex-1 flex justify-end items-center">
      <button
        id="menu-open"
        class="text-burdeaux z-[60]"
        aria-label="Open Menu"
      >
        <!-- ICON: Menu (SVG o componente) -->
      </button>
    </div>
  </div>

  <!-- MENU LATERAL -->
  <div
    id="mobile-menu"
    class="hidden fixed top-0 right-0 h-screen w-full sm:w-[35%] xl:w-[25%]
           bg-black/80 backdrop-blur-sm z-[70]
           px-6 lg:px-10 py-10
           flex flex-col items-center justify-center sm:items-start sm:justify-start
           shadow-lg"
  >
    <!-- Close -->
    <button
      id="menu-close"
      class="absolute top-0 right-0 p-8"
      aria-label="Close Menu"
    >
      <!-- ICON: X -->
    </button>

    <nav class="mt-[-30%] sm:mt-8 flex flex-col gap-10 sm:gap-4">
      {navigation.map((item) =>
        item.label === "Contattaci" ? (
          <button
            data-contact
            class="bg-amarilloPastel text-burdeaux font-semibold
                   text-4xl sm:text-lg lg:text-xl
                   px-6 py-3 sm:px-4 sm:py-2
                   rounded-sm hover:scale-105 transition"
          >
            {item.label}
          </button>
        ) : (
          <a
            href={item.href}
            class="text-white text-center text-4xl sm:text-lg lg:text-xl
                   hover:text-amarillo transition"
          >
            {item.label}
          </a>
        )
      )}
    </nav>
  </div>
</header>

<script>
  // === DOM refs ===
  const header = document.getElementById("catering-header");
  const menu = document.getElementById("mobile-menu");
  const openBtn = document.getElementById("menu-open");
  const closeBtn = document.getElementById("menu-close");
  const contactOverlay = document.getElementById("contact-overlay");

  if (!header || !menu || !openBtn || !closeBtn || !contactOverlay) {
    console.warn("CateringHeader: missing DOM elements");
    return;
  }

  // === Page context ===
  const isEventiHome = window.location.pathname === "/eventi";

  // === Robust scroll getter (Astro-safe) ===
  const getScrollY = () =>
  
    window.scrollY ||
    document.documentElement.scrollTop ||
    document.body.scrollTop ||
    0;

  // === Scroll effect ===
  const onScroll = () => {
    const y = getScrollY();

    if (!isEventiHome || y > 8) {
      header.classList.add("backdrop-blur-md", "bg-amarilloPastel/40");
    } else {
      header.classList.remove("backdrop-blur-md", "bg-amarilloPastel/40");
    }
  };

  // === Init (ensure layout is ready) ===
  const init = () => {
    onScroll();
    window.addEventListener("scroll", onScroll, { passive: true });
  };

  if (document.readyState === "complete") {
    requestAnimationFrame(init);
  } else {
    window.addEventListener("load", () => requestAnimationFrame(init));
  }

  // === Menu ===
  openBtn.addEventListener("click", () => {
    menu.classList.remove("hidden");
  });

  closeBtn.addEventListener("click", () => {
    menu.classList.add("hidden");
  });

  // === Contact overlay ===
  document.querySelectorAll("[data-contact]").forEach((btn) => {
    btn.addEventListener("click", () => {
      menu.classList.add("hidden");
      contactOverlay.classList.remove("hidden");
    });
  });
</script>

